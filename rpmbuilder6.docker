FROM centos:6.10

LABEL name="CentOS 6.x RPMBuilder Image" \
      license="MIT" \
      vendor="GONGLED" \
      maintainer="Gleb E Goncharov" \
      build-date="2019-07-16"

###############################################################################

ARG GOSU_VERSION=1.10

###############################################################################

RUN yum -y -q install https://yum.kaos.st/kaos-repo-latest.el6.noarch.rpm \
                   epel-release wget && \
    wget http://people.centos.org/tru/devtools-2/devtools-2.repo -O /etc/yum.repos.d/devtools-2.repo && \
    yum -y -q clean metadata && \
    yum -y -q update && \
    yum -y -q clean all

RUN yum -y -q --enablerepo=kaos-testing install sudo rpmbuilder make which rpmlint perfecto && \
    yum -y -q clean all

RUN curl -o /usr/local/bin/gosu -sSL "https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-amd64" \
    && chmod +x /usr/local/bin/gosu

COPY SOURCES/rpmbuilder6/entrypoint.sh /usr/local/bin/entrypoint.sh
COPY SOURCES/rpmbuilder6/rpmlint.conf /home/rpmbuilder/.config/rpmlint

RUN chmod +x /usr/local/bin/entrypoint.sh

VOLUME /rpmbuilder
WORKDIR /rpmbuilder

ENTRYPOINT ["/usr/local/bin/entrypoint.sh"]
